<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

<meta http-equiv="X-UA-Compatible" content="IE=EmulateIE11" /><meta name="copyright" content="(C) Copyright 2023" />
<meta name="DC.rights.owner" content="(C) Copyright 2023" />
<meta name="generator" content="DITA-OT" /><meta name="DC.type" content="topic" />
<meta name="DC.title" content="Certificate Download OTA Demo" />
<meta name="DC.relation" scheme="URI" content="GUID-0F3F81B8-4EC2-400B-BA38-648D7FD12A61.html" />
<meta name="DC.format" content="XHTML" />
<meta name="DC.identifier" content="certificate-download-ota-demo" />
<link rel="stylesheet" type="text/css" href="stylesheets/atmel.css" />
<title>Certificate Download OTA Demo</title>
<meta name="Microsoft.Help.Id" content="GUID-AD5B776E-19C6-49CD-A7CF-B692D58694C2-certificate-download-ota-demo" />
<meta name="Microsoft.Help.TocParent" content="GUID-AD5B776E-19C6-49CD-A7CF-B692D58694C2" />
<meta name="Microsoft.Help.TocOrder" content="0" />
<meta name="Microsoft.Help.Locale" content="en-US" />
<meta name="Microsoft.Help.TopicLocale" content="en-US" />
<meta name="Microsoft.Help.DisplayVersion" content="MPLAB Harmony WINC3400 Wireless Applications Reference A 05/2023" />
<script language="javascript">
       
       if (window.parent.location.protocol != 'file:') {
				document.addEventListener('click', function(e) {
				    if (e.target) {
               if (e.target.nodeName == "A" ) {
                    if (!e.target.target) {
                      e.preventDefault();
                      e.stopPropagation();
                              
                      var origUrl = window.parent.location.href.substr(0, window.parent.location.href.indexOf("?"));
                      if (origUrl.length === 0) {
                          origUrl = window.parent.location.href;
                      }
                      var href= e.target.getAttribute("href");
                      var parts = href.split("#");
          
                      var url = "";
                      if (parts.length == 2 ) {
                        if (!parts[0].length) {
                            url = window.parent.location.search.replace('?','')
                        } else {
                            url = parts[0].replace('.html','');
                        }
                      } else {
                        url = parts[0].replace('.html','');
                      }

                      if (parts.length == 2) {
                          url += "#" + parts[1];
                      }
    
                      window.parent.location.href = origUrl + "?" + url;

                      return false;
                    }
               }
            }
				});
			}

		</script><script language="javascript">
         
         function copyContent(content, button) {
         
            var textArea = document.createElement("textarea");
            
            // Place in the top-left corner of screen regardless of scroll position.
            textArea.style.position = 'fixed';
            textArea.style.top = 0;
            textArea.style.left = 0;
            
            // Ensure it has a small width and height. Setting to 1px / 1em
            // doesn't work as this gives a negative w/h on some browsers.
            textArea.style.width = '2em';
            textArea.style.height = '2em';
            
            // We don't need padding, reducing the size if it does flash render.
            textArea.style.padding = 0;
            
            // Clean up any borders.
            textArea.style.border = 'none';
            textArea.style.outline = 'none';
            textArea.style.boxShadow = 'none';
            
            // Avoid flash of the white box if rendered for any reason.
            textArea.style.background = 'transparent';
            
            textArea.value = content;
            
            document.body.appendChild(textArea);
            textArea.focus();
            textArea.select();
            
            try {
               var successful = document.execCommand('copy');
               var msg = successful ? 'successful' : 'unsuccessful';
               if (!button.classList.contains("copied")){
                  button.textContent = "Copied";
                  button.classList.add("copied");
                  setTimeout(function(){
                     button.textContent = "Copy";
                     button.classList.remove("copied");
                  },1000);
               }
            } catch (err) {
               console.log('Oops, unable to copy');
            }
            
            document.body.removeChild(textArea);
         }
         
         function cpy(id, button) {
            var element = document.getElementById(id);
            var content = element.getAttribute("content");
            
            copyContent(content, button);
         }
         
         document.addEventListener("DOMContentLoaded", function(event) {
            document.querySelectorAll(".codeblock").forEach(function(elem) {
               elem.style.position = "relative";
               var copy = document.createElement("button");
               copy.textContent = "Copy";
               copy.setAttribute("class", "copy-code");
               
               var content = elem.textContent;
               
               copy.addEventListener("click", function(){
                  copyContent(content, copy);
               });
               
               elem.addEventListener("mouseenter", function(evt){
                  elem.prepend(copy);
               });
            });
            
            document.querySelectorAll(".codeblock").forEach(function(elem) {
               elem.addEventListener("mouseleave", function(evt){
                  document.querySelector(".copy-code").remove();
               });
            });
         });
         
      </script><script language="javascript">
          
          // Add the MathML namespace to html
          var html = document.getElementsByTagName("html")[0],
          head = document.getElementsByTagName("head")[0];
          
          var mathJax = document.createElement("script");
          mathJax.src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-MML-AM_CHTML";
          head.appendChild(mathJax);
          
          html.setAttribute("xmlns:m","http://www.w3.org/1998/Math/MathML");
          
          function inIframe() { try { return window.self !== window.top; } catch (e) { return true; } }
          
          if (!inIframe()) { 
          
          var Default = "index.html?GUID-75D92290-831A-4383-BDF2-FBDB8F6E651B"; 
          
          var displaylocation = "value" + window.location.href;
          
          var GUIDS = displaylocation.split('GUID');          
          
          if (displaylocation.indexOf('#GUID') != -1) {            
          var First = GUIDS[1].split('.html');  
          if (GUIDS[3]){First = GUIDS[2].split('.html');}
          if (GUIDS[4]){First = GUIDS[3].split('.html');}
          if (GUIDS[5]){First = GUIDS[4].split('.html');}
          
          var Second = GUIDS[2].split('#');   
          if (GUIDS[3]){Second = GUIDS[3].split('#');}
          if (GUIDS[4]){Second = GUIDS[4].split('#');}
          if (GUIDS[5]){Second = GUIDS[5].split('#');}
          
          Default = "index.html?" + "GUID" + First[0] + "GUID" + Second[0];     
          }                    
          window.top.location = Default;
          }       
          
        </script><link rel="stylesheet" type="text/css" href="syntax-highlight.css" /><style xml:space="">
        
          button.copy-code{
            display:none;
            padding:0.7em 1.4em;
            margin:0 0.3em 0.3em 0;
            border-radius:0.15em;
            box-sizing: border-box;
            text-decoration:none;
            font-family:'Roboto',sans-serif;
            text-transform:uppercase;
            font-weight:400;
            color:#FFFFFF;
            background-color:#9c9c9c;
            box-shadow:inset 0 -0.6em 0 -0.35em rgba(0,0,0,0.17);
            text-align:center;
            position:relative;
            border: 0;
            float: right;
            border-radius: .5em;
            cursor: pointer;
          }
          button.copy-code:active{
            top:0.1em;
          }
          
          pre:hover button.copy-code{
            display: inline-block !important;
          }
          button.copy-code.copied {
            cursor: default !important;
          }
          
          
          @media all and (max-width:30em){
            button.copy-code{
              display:block;
              margin:0.4em auto;
            }
          }
        
        
      </style><link rel="stylesheet" type="text/css" href="syntax-highlight.css" /></head>
<body id="certificate-download-ota-demo">
<h1 class="title topictitle1" id="ariaid-title1" style="">Certificate Download OTA Demo</h1><div class="body"><p class="p">This example demonstrates how to download the Root/TLS certificates into WINC3400 via OTA. It downloads the certificates from an OTA download server, which is a web server.</p>
<p class="p"><strong class="ph b">Note:</strong></p>
<p class="p">This example will be only available with SAME54 Host.</p>
<ol class="ol"><li class="li"><span class="indent-level-default">1.</span><p class="p">Use any HTTP server or hfs.exe from http://www.rejetto.com/hfs/</p>
</li>
<li class="li"><span class="indent-level-default">2.</span><p class="p">Run the hfs.exe</p>
</li>
<li class="li"><span class="indent-level-default">3.</span><p class="p">Add the certificates from the “\utilities\cert_store” to the root folder in the hfs.exe tool.</p>
<br /><img class="image" src="GUID-D5270200-0E48-4C10-B366-5E3B8ED86AEB-low.png" alt="cert_down_ota_1" /><br /></li>
<li class="li"><span class="indent-level-default">4.</span><p class="p">Configure the wifi parameters using "wifi set" command.</p>
<br /><img class="image" src="GUID-4DC916AC-6E5D-4F01-94F4-4D5AE0B066E8-low.png" alt="ping_demo_config" /><br /></li>
<li class="li"><span class="indent-level-default">5.</span><p class="p">Copy the URL from server.</p>
<br /><img class="image" src="GUID-36D42737-41E4-47A1-A47D-7D1D92F21CE5-low.png" alt="cert_ota_updated" /><br /></li>
<li class="li"><span class="indent-level-default">6.</span><p class="p">Enter the command "cert &lt;url&gt;".</p>
<br /><img class="image" src="GUID-DF01A3A0-E6C0-420B-A003-F27F06C21244-low.png" alt="cert_down_ota_3" /><br /></li>
<li class="li"><span class="indent-level-default">7.</span><p class="p">Enter the application command "appdemo start 1 19" to run the Certificate download via OTA demo. First the device will connect to the network.</p>
<br /><img class="image" src="GUID-52EE1DE5-CAA3-4D86-AE0D-9661FB93BEDE-low.png" alt="cert_down_ota_4" /><br /></li>
<li class="li"><span class="indent-level-default">8.</span><p class="p">After the IP address has displayed on the terminal window, application will execute the CERT command and starts the certificate download.</p>
<br /><img class="image" src="GUID-CE69992A-8510-4EEB-8057-EA3C47C623D0-low.png" alt="cert_ota_log_new" /><br /></li>
</ol>
</div>
<div class="related-links">
<div class="familylinks">
<div class="parentlink"><strong>Parent topic:</strong> <a class="link" href="GUID-0F3F81B8-4EC2-400B-BA38-648D7FD12A61.html">WINC3400 Socket Mode Demo Applications</a></div>
</div>
</div><div class="topic nested1" aria-labelledby="ariaid-title2" id="download-root-certificates-as-single-image-as-a-bundle"><h2 class="title topictitle2" id="ariaid-title2" style="">Download Root Certificates as Single Image (as a bundle)</h2><div class="body"><p class="p">The existing application can download the Root certificates in der or pem format. If the user wants to convert the certificates into custom WINC format and download it as single imgae (as a bundle), follow the below mentioned steps.</p>
<ol class="ol"><li class="li"><span class="indent-level-default">1.</span><p class="p">Enable the macro "ROOT_CERT_BUNDLE" in "app_cert_download_ota.c"</p>
</li>
<li class="li"><span class="indent-level-default">2.</span><p class="p">The root certificate format to be used with winc flash is a winc custom format. User can use the "wireless_wifi\utilities\wifi\winc\tools\image_tool.exe" to convert the root certificate to required format. User can use the method mentioned in step 3 to convert the certificate into custom WINC format and rename the file as "root_certs.bin"</p>
</li>
<li class="li"><span class="indent-level-default">3.</span><p class="p">Create a single config file to create only the root certificate region as mentioned below.</p>
<pre class="pre codeblock"><code id="d14122e83" content="     [flash]&#xD;&#xA;&#xD;&#xA;     size is 1M&#xD;&#xA;&#xD;&#xA;     default is 0&#xD;&#xA;&#xD;&#xA;     region at 0x005000 is [root certificates]&#xD;&#xA;&#xD;&#xA;     [root certificates]&#xD;&#xA;&#xD;&#xA;     type is root certificates&#xD;&#xA;&#xD;&#xA;     schema is 2&#xD;&#xA;&#xD;&#xA;     size is 4K&#xD;&#xA;&#xD;&#xA;     default is 0xff&#xD;&#xA;&#xD;&#xA;     file is ../root_certs/AmazonRootCA1.cer&#xD;&#xA;&#xD;&#xA;     file is ../root_certs/BaltimoreCyberTrustRoot.cer&#xD;&#xA;&#xD;&#xA;     file is ../root_certs/DigiCert.cer&#xD;&#xA;&#xD;&#xA;     file is ../root_certs/DigiCertSHA2.cer&#xD;&#xA;&#xD;&#xA;     file is ../root_certs/EnTrust.cer&#xD;&#xA;&#xD;&#xA;     file is ../root_certs/GlobalSignRoot.cer&#xD;&#xA;&#xD;&#xA;     file is ../root_certs/ISRGRootX1.cer&#xD;&#xA;&#xD;&#xA;     file is ../root_certs/QuoVadis_Root.cer&#xD;&#xA;&#xD;&#xA;     file is ../root_certs/VeriSign.cer&#xD;">     [flash]&#xD;
&#xD;
     size is 1M&#xD;
&#xD;
     default is 0&#xD;
&#xD;
     region at 0x005000 is [root certificates]&#xD;
&#xD;
     [root certificates]&#xD;
&#xD;
     type is root certificates&#xD;
&#xD;
     schema is 2&#xD;
&#xD;
     size is 4K&#xD;
&#xD;
     default is 0xff&#xD;
&#xD;
     file is ../root_certs/AmazonRootCA1.cer&#xD;
&#xD;
     file is ../root_certs/BaltimoreCyberTrustRoot.cer&#xD;
&#xD;
     file is ../root_certs/DigiCert.cer&#xD;
&#xD;
     file is ../root_certs/DigiCertSHA2.cer&#xD;
&#xD;
     file is ../root_certs/EnTrust.cer&#xD;
&#xD;
     file is ../root_certs/GlobalSignRoot.cer&#xD;
&#xD;
     file is ../root_certs/ISRGRootX1.cer&#xD;
&#xD;
     file is ../root_certs/QuoVadis_Root.cer&#xD;
&#xD;
     file is ../root_certs/VeriSign.cer&#xD;</code></pre></li>
</ol>
<p class="p">Then run the below mentioned command,wireless_wifi\utilities\wifi\winc\files\winc3400&gt;....\tools\image_tool.exe -c 1.4.4\root_certs.config -o root_certs.bin -of raw</p>
<p class="p">This will create a 1MB binary flash image with the root certificates located at 0x5000 to 0x6000. Then that part  of the file  can be extracted to have the new root certificate area.</p>
<p class="p">After creating the image, place this "root_cert.bin" file in the HTTP server and follow the steps 4 to 8 to run the application.</p>
</div>
</div>
<div class="topic nested1" aria-labelledby="ariaid-title3" id="root-certificate-format-in-winc3400"><h2 class="title topictitle2" id="ariaid-title3" style="">Root Certificate format in WINC3400</h2><div class="body"><p class="p">Given below is an example of a WINC3400 root certificate store with first two certificates (out of a total of 9).</p>
<br /><img class="image" src="GUID-ABF2E5A4-C99C-4EC7-A3C8-C352C9ECA387-low.png" alt="flash_cert_format_1" /><br /></div>
</div>
</body>
</html>